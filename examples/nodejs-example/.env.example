# ============================================
# Application Configuration
# ============================================
PORT=3000

# ============================================
# OpenTelemetry Configuration
# ============================================

# Service Identification
OTEL_SERVICE_NAME=nodejs-example
OTEL_RESOURCE_ATTRIBUTES=deployment.environment=development,service.version=1.0.0,team=backend

# OTLP Exporter Configuration
# For local development (Alloy HTTP)
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4320
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf

# For Docker (Alloy gRPC - recommended for production)
# OTEL_EXPORTER_OTLP_ENDPOINT=http://alloy:4317
# OTEL_EXPORTER_OTLP_PROTOCOL=grpc

# Enable All Signals
OTEL_TRACES_EXPORTER=otlp
OTEL_METRICS_EXPORTER=otlp
OTEL_LOGS_EXPORTER=otlp

# Sampling Configuration
# Development: 1.0 = 100% (sample everything)
# Production: 0.1 = 10% (recommended starting point)
OTEL_TRACES_SAMPLER=parentbased_traceidratio
OTEL_TRACES_SAMPLER_ARG=1.0

# Batch Span Processor Configuration (Production)
OTEL_BSP_MAX_QUEUE_SIZE=2048
OTEL_BSP_MAX_EXPORT_BATCH_SIZE=512
OTEL_BSP_SCHEDULE_DELAY=5000

# Metric Export Interval (milliseconds)
OTEL_METRIC_EXPORT_INTERVAL=60000

# Propagators for Distributed Tracing
OTEL_PROPAGATORS=tracecontext,baggage

# Log Level (debug, info, warn, error)
OTEL_LOG_LEVEL=info

# Optional: Disable specific instrumentations (if causing issues)
# OTEL_NODE_DISABLED_INSTRUMENTATIONS=fs,dns

# ============================================
# Pyroscope Profiling (Recommended)
# ============================================

# Enable continuous profiling
PYROSCOPE_SERVER_ADDRESS=http://localhost:4100
PYROSCOPE_APPLICATION_NAME=nodejs-example
PYROSCOPE_TAGS=environment=development,version=1.0.0
PYROSCOPE_SAMPLE_RATE=100

# For Docker
# PYROSCOPE_SERVER_ADDRESS=http://alloy:4100

# ============================================
# Production Recommendations
# ============================================

# 1. Use gRPC protocol for better performance:
#    OTEL_EXPORTER_OTLP_PROTOCOL=grpc

# 2. Lower sampling in production (10-20%):
#    OTEL_TRACES_SAMPLER_ARG=0.1

# 3. Set appropriate batch sizes:
#    OTEL_BSP_MAX_QUEUE_SIZE=2048
#    OTEL_BSP_MAX_EXPORT_BATCH_SIZE=512

# 4. Add meaningful resource attributes:
#    OTEL_RESOURCE_ATTRIBUTES=deployment.environment=production,service.version=1.2.3,cloud.region=us-east-1

# 5. Enable profiling for production:
#    PYROSCOPE_SERVER_ADDRESS=http://alloy:4100

# ============================================
# NestJS Applications
# ============================================

# For NestJS apps, see .env.nestjs.example for comprehensive configuration
# including framework-specific settings and best practices
